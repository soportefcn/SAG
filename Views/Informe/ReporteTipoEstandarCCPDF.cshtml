@model SAG2.Models.Informe
@{
    ViewBag.Title = "ReportePrograma";
    SAG2.Models.SAG2DB db = new SAG2.Models.SAG2DB();

    Layout = null;
    ViewBag.Title = "Reporte por linea";
    SAG2.Classes.Util utils = new SAG2.Classes.Util();
    string FechaSis = DateTime.Now.ToShortDateString();
}
<script type="text/javascript">
    $(document).ready(function () {
        $(".js-autocomplete").select2();
    });
</script>

@if (ViewBag.IdtipoPrograma != null)
{
    try
    {
        int mesSeleccion = ViewBag.Mes;
        var Meses = ViewBag.GrupoMeses;
        var NombreMeses = new string[12]
        {
"Ene.",
"Feb.",
"Mar.",
"Abr.",
"May.",
"Jun.",
"Jul.",
"Ago.",
"Sep.",
"Oct.",
"Nov.",
"Dic."
        };
        //List<SAG2.Models.Cuenta> cuentas = new List<SAG2.Models.Cuenta>();
        List<SAG2.Models.DetalleInformes> listaCuentas = ViewBag.listaCuentas;
        int id = ViewBag.IdtipoPrograma;
        int periodo = ViewBag.Periodo;
        var presupuestoID = db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().ID;
        var presupuestoDetalle = db.DetallePresupuesto.Where(p => p.Presupuesto.Proyecto.TipoProyecto.ID == id).ToList();
        //  int mes = 1;
        var ingresos = db.Movimiento.Where(m => m.Proyecto.TipoProyecto.ID == id && m.Periodo == periodo && m.Temporal == null).ToList();
        var egresos = db.DetalleEgreso.Where(e => e.Egreso.Proyecto.TipoProyecto.ID == id && e.Egreso.Periodo == periodo && e.Egreso.Temporal == null).ToList();
        var reintegros = db.DetalleReintegro.Where(r => r.Reintegro.Proyecto.TipoProyecto.ID == id && r.Reintegro.Periodo == periodo && r.Reintegro.Temporal == null).ToList();
        var totalEgreso = new double[13];
        var totalPresupuestoE = new double[13];
        var totalIngresosEgreso = new double[13];
        var totalesIngresos = new double[13];
        var totalesEgresos = new double[13];
        var totalPresupuesto = new double[13];
        var totalesPresupuestosIngresos = new double[13];
        var totalesPresupuestosEgresos = new double[13];
        var pruebacuentas = db.Cuenta.ToList();
        var presupuestoInicial = new double[13];
        var saldoInicial = new double[13];

        double presupuestoCabecera = 0;

    @*<ul>*@
    //foreach (var listado in listaCuentas.Where(a => a.estado == 0).OrderBy(c => c.cuentaID))
    //{
    //    SAG2.Models.Cuenta cuenta = db.Cuenta.First(i => i.ID == listado.cuentaID);
    //    cuentas.Add(cuenta);
    //    cuentas.OrderBy(c => c.Orden);
    //}

    <div class="col-md-12" style="overflow-y: hidden;" id="prueba ocultoImpresion">
        <table border="1" class="table table-bordered table-hover">
            <tr>
                <tH>CONTROL PRESUPUESTARIO</tH>
                <tH>@db.TipoProyecto.Find(id).NombreLista</tH>

            </tr>
            <tr>

                <th rowspan="2">CONCEPTO</th>
                @foreach (var mes in Meses)
                {
                    <th colspan="4"> @NombreMeses[mes - 1]</th>
                    if (mes == 12)
                    {
                        <th colspan="5">Totales</th>
                    }
                }
            </tr>
            <tr>
                @foreach (var mes in Meses)
                {
                    <th style="width:80px !important;">Pres. $</th>
                    <th style="width:80px !important;">Real $</th>
                    <th style="width:80px !important;"> Desv. $</th>
                    <th style="width:80px !important;"> Desv. %</th>
                    if (mes == 12)
                    {
                        <th style="width:80px !important;">Pres. $</th>
                        <th style="width:80px !important;">Real $</th>
                        <th style="width:80px !important;"> Desv. $</th>
                        <th style="width:80px !important;"> Desv. %</th>
                        <th style="width:80px !important;"> % Ingr.</th>
                    }

                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">INGRESOS</th>
            </tr>

            <tr style=";">
                <th style="background-color: silver; text-align: left">1. Subvención</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 3)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 3) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 3) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 3) && p.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }


                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">2. Sobreatenciones/Interv. 80 bis</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 5)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {

                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 5) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 5) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {

                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 5) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 5) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 5) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 5) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }

                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">3. Anticipo Subvención</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 4)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 4) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 4) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 4) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 4) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 4) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 4) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">4. Otros Aportes del Sename/Servicio Mejor Ni&ntilde;ez</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 8 && p.CuentaID == 10)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 8 && p.CuentaID == 10) && p.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 8 && e.CuentaID == 10) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 8 && p.CuentaID == 10) && p.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 8 && e.CuentaID == 10) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 8 && p.CuentaID == 10) && p.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 8 && e.CuentaID == 10) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }

                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">5. Otros Ingresos</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 12 && p.CuentaID == 14)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 12 && p.CuentaID == 14) && p.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 12 && e.CuentaID == 14) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 12 && p.CuentaID == 14) && p.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 12 && e.CuentaID == 14) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 12 && p.CuentaID == 14) && p.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 12 && e.CuentaID == 14) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>INGRESOS</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Egresos</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1. Personal</th>
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">a. Remuneraciones</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }

                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">b. Próvision de Fondos para Indemnizaciones</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 41)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Personal</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41)).Sum(m => m.Monto);
                    double valorDif = valorIngresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto != 0)
                        {@valorPresupuesto.ToString("$#,##")
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }



                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                            @((valorPresupuesto).ToString("$#,###"))

                        </td>
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                        <td>@((valorDif).ToString("$#,###"))</td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2. Operación</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">a. Funcionamiento</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Consumos Básicos</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Arriendo Inmueble</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 44)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 44)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 44) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 44) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 44) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 44) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 44) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 44) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }


                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Materiales de Escritorio y Aseo</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">4) Mantención y Reparaciones</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Servicios Generales </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">6) Caja Chica y Fondos a Rendir</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">7) Aportes a la Administración Central</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 64)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 64)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 64) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 64) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 64) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 64) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 64) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 64) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">8) Devoluci&oacute;n de fondos al Sename/Servicio Mejor Ni&ntilde;ez</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 145)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 145)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 145) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 145) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 145) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 145) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 145) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 145) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Funcionamiento</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }

                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">b. Apoyo Técnico</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Alimentación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 66)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Autocuidado</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 146)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 146)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 146)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 146) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }



                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>

                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 146)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 146) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 146)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 146) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 146)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 146) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{ double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Capacitación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 68)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 68)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 68) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 68) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 68) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 68) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 68) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 68) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">4) Materiales e Insumos Técnicos</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 69)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 69)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 69) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 69) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 69) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 69) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 69) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 69) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Movilización</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12)
                    {
                        valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                        valorPresupuestoE = presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Total Apoyo Técnico</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">
                    c. Apoyo Beneficiario
                </th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Alimentación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 72)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Ayuda a las Familias</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 73)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 73)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {

                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 73) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 73) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {

                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 73) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 73) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {

                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 73) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 73) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Capacitación y Educación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 4) Deportes y Recreación </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 75)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 75)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 75) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 75) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 75) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 75) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 75) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 75) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Movilización </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 77)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 77)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 77) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 77) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 77) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 77) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 77) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 77) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">6) Salud e Higiene </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 78)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 78)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 78) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 78) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 78) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 78) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 78) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 78) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 7) Vestuario y Calzador</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th> Total Apoyo Beneficiario </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th> Total Operación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 3. Inversión </th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> a. Equipamiento </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if (mes == 12 && mesSeleccion == 15)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 12 && mesSeleccion == 14)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                    if (mes == 6 && mesSeleccion == 13)
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;

                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> b. Infraestructura </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 43)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 43)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th > Total Operación </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 6 && mesSeleccion == 13) || (mes == 12 && mesSeleccion == 14))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th style="background-color: silver; text-align: left">Total Egresos</th>
                @foreach (var mes in Meses)
                {   //valorIngresos
                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);

                    //valorEgresos
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                    double valorDif = valorEgresos - valorPresupuesto;
                    double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorPresupuesto - valorPresupuestoE != 0)
                        {@((valorPresupuesto.ToString("#,###")))
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorIngresos += ingresos.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto += @presupuestoDetalle.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);

                            //valorEgresos
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        valorDif = valorEgresos - valorPresupuesto;
                        valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                        <td>
                            @if (valorPresupuesto - valorPresupuestoE != 0)
                            {@((valorPresupuesto.ToString("#,###")))
                            { totalPresupuesto[mes] += valorPresupuesto; }
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>

                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                //   totalIngresosEgreso[mes] += valorIngresos;
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorDif != 0)
                            {@valorDif.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }

                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th style="background-color: silver; text-align: left">Resultado</th>
                @foreach (var mes in Meses)
                {   //valorIngresos
                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12)).Sum(m => m.Monto);

                    //valorEgresos
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                    double valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                    double valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuesto - valorPresupuestoE != 0)
                        {@((valorPresupuesto - valorPresupuestoE).ToString("#,###"))
                        { totalPresupuesto[mes] += valorPresupuesto; }
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>

                    <td>
                        @if (valorIngresos - valorEgresos != 0)
                        {@((valorIngresos - valorEgresos).ToString("$#,###"))
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                            totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDif != 0)
                        {@valorDif.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto += @presupuestoDetalle.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Mes == meses).Sum(m => m.Monto);

                            //valorEgresos
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                        valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuesto - valorPresupuestoE != 0)
                            {@((valorPresupuesto - valorPresupuestoE).ToString("#,###"))
                            { totalPresupuesto[mes] += valorPresupuesto; }
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>

                        <td>
                            @if (valorIngresos - valorEgresos != 0)
                            {@((valorIngresos - valorEgresos).ToString("$#,###"))
                            {
                                //   totalIngresosEgreso[mes] += valorIngresos;
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorDif != 0)
                            {@valorDif.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos - valorIngresos) / valorIngresos) * 100))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Financimiento </th>
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th style="background-color: silver; text-align: left">Saldo Inicial</th>
                @foreach (var mes in Meses)
                {
                    //valorIngresos
                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12)).Sum(m => m.Monto);
                    valorIngresos += ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 17 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    valorIngresos -= ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    valorPresupuesto += @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 10 || p.CuentaID == 14 || p.CuentaID == 16 || p.CuentaID == 17 || p.CuentaID == 17 || p.CuentaID == 158 || p.CuentaID == 20)).Sum(m => m.Monto);
                    valorPresupuesto -= @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 40 || p.CuentaID == 63 || p.CuentaID == 155 || p.CuentaID == 156 || p.CuentaID == 157)).Sum(m => m.Monto);

                    //valorEgresos
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                    double valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                    double valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;


                    <td>
                        @if (mes == 1)
                        {
                            {
                                presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                totalPresupuesto[mes] += valorPresupuesto;
                            }

                            @( (presupuestoInicial[mes]).ToString("#,###"))
                            { presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorPresupuesto - valorPresupuestoE); }
                        }
                        else
                        {
                            @((presupuestoInicial[mes - 1]).ToString("#,###"))
                            {
                                totalPresupuesto[mes] += valorPresupuesto;
                                presupuestoInicial[mes] += presupuestoInicial[mes - 1] + (((Convert.ToInt32(valorPresupuesto)) - Convert.ToInt32(valorPresupuestoE)));
                            }
                        }
                    </td>
                    <td>
                        @if (mes == 1)
                        {
                            saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                            @((saldoInicial[mes]).ToString("$#,###"))
                            { saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorIngresos - valorEgresos); }
                            {
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {
                            @((saldoInicial[mes - 1]).ToString("$#,###"))
                            { saldoInicial[mes] = saldoInicial[mes - 1] + Convert.ToInt32(valorIngresos - valorEgresos); }
                        }
                    </td>
                    <td>
                        @if (mes == 1)
                        {

                            @( 0)

                        }
                        else
                        {
                            valorDif = saldoInicial[mes - 1] - presupuestoInicial[mes - 1];
                            @( (valorDif).ToString("$#,###"))
                        }
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        <td>
                            @{ presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                totalPresupuesto[mes] += valorPresupuesto;}
                            @( (presupuestoInicial[mes]).ToString("#,###"))
                            @{ presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt64(valorPresupuesto - valorPresupuestoE); }
                        </td>
                        <td>
                            @{ presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                totalPresupuesto[mes] += valorPresupuesto;}
                            @( (presupuestoInicial[mes]).ToString("#,###"))
                            @{ presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt64(valorPresupuesto - valorPresupuestoE); }
                        </td>
                        <td>$0</td>
                        <td>0,00%</td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (valorIngresos / valorIngresos)))
                        </td>
                    }

                }

            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Prestamos y Traspasos Institucionales y Programas </th>
                @foreach (var mes in Meses)
                {

                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);

                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto);
                    double valorPresupuesto = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158)).Sum(m => m.Monto);
                    double DifEgresos = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                    double DifEgresosPor = (DifEgresos / (valorPresupuesto - valorPresupuestoE)) * 100;
                    <td>
                        @if ((valorPresupuesto - valorPresupuestoE) != 0)
                        {@((valorPresupuesto - valorPresupuestoE).ToString("$#,##"))
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if ((valorIngresos - valorEgresos) != 0)
                        {@((valorIngresos - valorEgresos).ToString("$#,###"))
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        double ValorIngresos = 0;
                        foreach (var meses in Meses)
                        {
                            ValorIngresos += ingresos.Where(e => (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159) && e.Mes == meses).Sum(m => m.Monto);
                            valorPresupuesto += presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if ((valorPresupuesto - valorPresupuestoE) != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if ((ValorIngresos - valorEgresos) != 0)
                            {@((ValorIngresos - valorEgresos).ToString("$#,###"))
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    ValorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", (((ValorIngresos - valorEgresos) / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Aportes Institucionales </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = ingresos.Where(e => e.Temporal == null && e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 20)).Sum(m => m.Monto_Ingresos);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 20)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorPresupuestoE != 0)
                        {@valorPresupuestoE.ToString("$#,##")
                    }
                    else
                    { @Html.Raw("$0")}
                    </td>
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                            totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresos != 0)
                        {@DifEgresos.ToString("$#,###")}
                    else
                    {@Html.Raw("$0")}
                    </td>
                    <td>
                        @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuestoE != 0)
                            {@valorPresupuestoE.ToString("$#,##")
                        }
                        else
                        { @Html.Raw("$0")}
                        </td>
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresos != 0)
                            {@DifEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                        </td>
                        <td>
                            @if (DifEgresosPor != 0 && Double.IsNaN(DifEgresosPor) == false && Double.IsInfinity(DifEgresosPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", DifEgresosPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        <td>
                            @{double valorIngresos = 0;
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorEgresos / valorIngresos) * 100)))
                        </td>
                    }
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th style="background-color: silver; text-align: left">Saldo Final</th>
                @foreach (var mes in Meses)
                {
                    saldoInicial[mes] = 0;
                    presupuestoInicial[mes] = 0;
                    //valorIngresos
                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    double valorPresupuesto = @presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12)).Sum(m => m.Monto);
                    valorIngresos += ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 17 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    valorIngresos -= ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    valorPresupuesto += @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 10 || p.CuentaID == 14 || p.CuentaID == 16 || p.CuentaID == 17 || p.CuentaID == 17 || p.CuentaID == 158 || p.CuentaID == 20)).Sum(m => m.Monto);
                    valorPresupuesto -= @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 40 || p.CuentaID == 63 || p.CuentaID == 155 || p.CuentaID == 156 || p.CuentaID == 157)).Sum(m => m.Monto);

                    //valorEgresos
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    double DifEgresos = valorEgresos - valorPresupuestoE;
                    double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                    double valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                    double valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;


                    <td>
                        @if (valorPresupuesto - valorPresupuestoE != 0 && mes == 1)
                        {
                            {
                                presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                totalPresupuesto[mes] += valorPresupuesto;
                            }

                            @( (presupuestoInicial[mes] + (valorPresupuesto - valorPresupuestoE)).ToString("#,###"))
                            { presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorPresupuesto - valorPresupuestoE); }
                        }
                        else
                        {
                            @((presupuestoInicial[mes - 1] + (valorPresupuesto - valorPresupuestoE)).ToString("#,###"))
                            {
                                totalPresupuesto[mes] += valorPresupuesto;
                                presupuestoInicial[mes] += presupuestoInicial[mes - 1] + (((Convert.ToInt32(valorPresupuesto)) - Convert.ToInt32(valorPresupuestoE)));
                            }
                        }
                    </td>
                    <td>
                        @if (valorIngresos - valorEgresos != 0 && mes == 1)
                        {
                            saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                            @((saldoInicial[mes] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                            { saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorIngresos - valorEgresos); }
                            {
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {
                            @((saldoInicial[mes - 1] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                            { saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorIngresos - valorEgresos); }
                        }
                    </td>
                    <td>
                        @if (valorDif != 0 && mes == 1)
                        {
                            valorDif = (saldoInicial[mes] - presupuestoInicial[mes]);
                            @( (valorDif).ToString("$#,###"))

                        }
                        else
                        {
                            valorDif = saldoInicial[mes - 1] - presupuestoInicial[mes - 1];
                            @( (valorDif).ToString("$#,###"))
                        }
                    </td>
                    <td>
                        @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                        {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                    else
                    {@Html.Raw("0%")}
                    </td>
                    { valorIngresos = 0; valorEgresos = 0; }
                    if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        saldoInicial[mes] = 0;
                        presupuestoInicial[mes] = 0;
                        //valorIngresos

                        foreach (var meses in Meses)
                        {
                            valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto = @presupuestoDetalle.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Mes == meses).Sum(m => m.Monto);
                            valorIngresos += ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 17 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorIngresos -= ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 10 || p.CuentaID == 14 || p.CuentaID == 16 || p.CuentaID == 17 || p.CuentaID == 17 || p.CuentaID == 158 || p.CuentaID == 20) && p.Mes == meses).Sum(m => m.Monto);
                            valorPresupuesto -= @presupuestoDetalle.Where(p => (p.CuentaID == 40 || p.CuentaID == 63 || p.CuentaID == 155 || p.CuentaID == 156 || p.CuentaID == 157) && p.Mes == meses).Sum(m => m.Monto);

                            //valorEgresos
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && e.Mes == meses && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                        valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;
                        <td>
                            @if (valorPresupuesto - valorPresupuestoE != 0 && mes == 1)
                            {
                                {
                                    presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                    totalPresupuesto[mes] += valorPresupuesto;
                                }

                                @( (presupuestoInicial[mes] + (valorPresupuesto - valorPresupuestoE)).ToString("#,###"))
                                { presupuestoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt32(valorPresupuesto - valorPresupuestoE); }
                            }
                            else
                            {
                                @((presupuestoInicial[mes - 1] + (valorPresupuesto - valorPresupuestoE)).ToString("#,###"))
                                {
                                    totalPresupuesto[mes] += valorPresupuesto;
                                    presupuestoInicial[mes] += presupuestoInicial[mes - 1] + (((Convert.ToInt64(valorPresupuesto)) - Convert.ToInt64(valorPresupuestoE)));
                                }
                            }
                        </td>
                        <td>
                            @if (valorIngresos - valorEgresos != 0 && mes == 1)
                            {
                                saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial);
                                @((saldoInicial[mes] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                                { saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt64(valorIngresos - valorEgresos); }
                                {
                                    totalesIngresos[mes] += valorIngresos;
                                    totalesPresupuestosIngresos[mes] += valorPresupuesto;
                                }
                            }
                            else
                            {
                                @((saldoInicial[mes - 1] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                                { saldoInicial[mes] = (@db.Presupuesto.Where(p => p.Proyecto.TipoProyecto.ID == id && p.Periodo == periodo).First().SaldoInicial) + Convert.ToInt64(valorIngresos - valorEgresos); }
                            }
                        </td>
                        <td>
                            @if (valorDif != 0 && mes == 1)
                            {
                                valorDif = (saldoInicial[mes] - presupuestoInicial[mes]);
                                @( (valorDif).ToString("$#,###"))

                            }
                            else
                            {
                                valorDif = saldoInicial[mes - 1] - presupuestoInicial[mes - 1];
                                @( (valorDif).ToString("$#,###"))
                            }
                        </td>
                        <td>
                            @if (valorDifPor != 0 && Double.IsNaN(valorDifPor) == false && Double.IsInfinity(valorDifPor) == false)
                            {@Html.Raw(string.Format("{0:N2}%", valorDifPor))}
                        else
                        {@Html.Raw("0%")}
                        </td>
                        { valorIngresos = 0; valorEgresos = 0; }
                        <td>
                            @{
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                                }
                            }
                            @(String.Format("{0:N2}%", ((valorIngresos - valorEgresos) / valorIngresos) * 100))
                        </td>
                    }
                }
                


            </tr>






        </table>
    </div>
    }
        catch (Exception)
        {
            <script>
                $(document).ready(function () {
                    $("#prueba").html('</br><diV class="alert alert-warning"> No existe información</div>');
                });
            </script>
        }
}
else
{
    @Html.Raw("No hay presupuesto para el proyecto");
}
