@model SAG2.Models.Informe
@{
    ViewBag.Title = "Reporte Región Estandar";
    Layout = "~/Views/Shared/_Layoutinf.cshtml";
    SAG2.Models.SAG2DB db = new SAG2.Models.SAG2DB();

}
<style media="print">
    @@page {
        size: landscape;
        margin: 1cm !important;
    }

    body {
        font-family: "Times New Roman" !important;
        margin: 0 !important;
        display: block !important;
        overflow: visible !important;
    }

    td {
        font-size: 10px !important;
    }

    th {
        font-size: 12px !important;
    }

    h2 {
        font-size: 16px !important;
        text-align: center;
    }

    .pie {
        display: none;
    }

    .permisos, .body, .contenedor {
        padding: 0 !important;
        border: 0 !important;
        display: block !important;
    }

    .permisos {
        width: 90% !important;
    }

    .ocultoImpresion, .menu, .top {
        display: none;
    }

    .soloImpresion {
        display: block;
    }

    .DatosPresupuesto {
        overflow: visible !important;
        display: block !important;
    }

    th {
        font-size: 11px !important;
    }
</style>
<style media="screen">
    th {
        font-size: 11px !important;
    }
</style>

@using (Html.BeginForm())
{
   <h2><i class="fa fa-file-text-o"></i> Reporte Estandar por Región</h2>
    <hr />
    @Html.ValidationSummary(false, "", new { @class = "text-danger" })

    <div class="row">
        <input id="Informe" class="form-control" type="hidden" value="1" name="Informe">
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
            <label class="control-label" for="Region">Región</label>
            @Html.DropDownList("region", null, htmlAttributes: new { @class = "form-control js-autocomplete" })
        </div>
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
            <label class="control-label" for="Mes">Mes</label>
            @Html.DropDownList("Mes", new List<SelectListItem> { new SelectListItem { Value = "1", Text = "Enero" }, new SelectListItem { Value = "2", Text = "Febrero" }, new SelectListItem { Value = "3", Text = "Marzo" }, new SelectListItem { Value = "4", Text = "Abril" }, new SelectListItem { Value = "5", Text = "Mayo" }, new SelectListItem { Value = "6", Text = "Junio" }, new SelectListItem { Value = "7", Text = "Julio" }, new SelectListItem { Value = "8", Text = "Agosto" }, new SelectListItem { Value = "9", Text = "Septiembre" }, new SelectListItem { Value = "10", Text = "Octubre" }, new SelectListItem { Value = "11", Text = "Noviembre" }, new SelectListItem { Value = "12", Text = "Diciembre" }, new SelectListItem { Value = "13", Text = "Primer Semestre" }, new SelectListItem { Value = "14", Text = "Segundo Semestre" }, new SelectListItem { Value = "15", Text = "Anual" } }, new { @class = "form-control js-autocomplete" })
        </div>
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
            <label class="control-label" for="Año">Año</label>
            @Html.DropDownList("periodo", new List<SelectListItem> { new SelectListItem { Value = "2017", Text = "2017" }, new SelectListItem { Value = "2018", Text = "2018" }, new SelectListItem { Value = "2019", Text = "2019" }, new SelectListItem { Value = "2020", Text = "2020" }, new SelectListItem { Value = "2021", Text = "2021" }, new SelectListItem { Value = "2022", Text = "2022" } }, new { @class = "form-control js-autocomplete" })
        </div>
    </div>
    <br/>
    <div class="row">
    <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 centrado">
        <input type="submit" name="ReportePrograma" value="Procesar" class="btn btn-primary" />
         @if (ViewBag.IdRegion != null)
        {
        @Html.ActionLink("Excel", "ReporteRegionEstandarExcel", "Informe", new { Informe = ViewBag.IdInforme, region = ViewBag.IdRegion, Mes = ViewBag.Mes, periodo = ViewBag.Periodo }, new { @class = "btn btn-success" })
        }
    </div></div><hr/>
}
@if (ViewBag.IdRegion != null)
{
    try
    {
        int mesSeleccion = ViewBag.Mes;
        var Meses = ViewBag.GrupoMeses;
        var NombreMeses = new string[12]
        {
"Ene.",
"Feb.",
"Mar.",
"Abr.",
"May.",
"Jun.",
"Jul.",
"Ago.",
"Sep.",
"Oct.",
"Nov.",
"Dic."
        };
    try{
    
    List<SAG2.Models.DetalleInformes> listaCuentas = ViewBag.listaCuentas;
    int id = ViewBag.IdRegion;
    int periodo = ViewBag.Periodo;
   // var presupuestoID = db.Presupuesto.Where(p => p.Proyecto.ID == id && p.Periodo == periodo).First().ID;
    //vvar presupuestoDetalle = db.DetallePresupuesto.Where(p => p.Presupuesto.Proyecto.ID == id && p.Periodo == periodo).ToList();
    //  int mes = 1;
    var ingresos = db.Movimiento.Where(m => m.Proyecto.Direccion.Comuna.RegionID    == id && m.Periodo == periodo && m.Temporal == null).ToList();
    var egresos = db.DetalleEgreso.Where(e => e.Egreso.Proyecto.Direccion.Comuna.RegionID    == id && e.Egreso.Periodo == periodo && e.Egreso.Temporal == null).ToList();
   // var reintegros = db.DetalleReintegro.Where(r => r.Reintegro.Proyecto.ID == id && r.Reintegro.Periodo == periodo && r.Reintegro.Temporal == null).ToList();
    var reintegros = db.Movimiento.Where(m => m.Proyecto.Direccion.Comuna.RegionID    == id).Where(m => m.TipoComprobanteID == 3).Where(m => m.CuentaID != null && m.CuentaID != 1 && m.Nulo == null && m.Eliminado == null && m.Temporal == null && m.Periodo == periodo).OrderBy(m => m.Cuenta.Orden).ToList();
    var reintegrosGastos = db.DetalleReintegro.Where(m => m.Reintegro.Proyecto.Direccion.Comuna.RegionID == id).Where(m => m.CuentaIDD != null && m.Reintegro.Periodo == periodo).OrderBy(m => m.CuentaIDD).ToList();

        
     var totalEgreso = new double[13];
    var totalPresupuestoE = new double[13];
    var totalIngresosEgreso = new double[13];
    var totalesIngresos = new double[13];
    var totalesEgresos = new double[13];
    var totalPresupuesto = new double[13];
    var totalesPresupuestosIngresos = new double[13];
    var totalesPresupuestosEgresos = new double[13];
    var pruebacuentas = db.Cuenta.ToList();
    var presupuestoInicial = new double[13];
    var saldoInicial = new double[13];
   
    double presupuestoCabecera = 0;



    <div class="col-md-12" style="overflow-y: scroll;" id="prueba ocultoImpresion">
        <table border="1" class="table table-bordered table-hover">
            <tr>
                <tH>Estado de Resultado</tH>
                <tH>@db.Region.Find(id).Nombre</tH>

            </tr>
            <tr>

                <th rowspan="2">CONCEPTO</th>
                @foreach (var mes in Meses)
                {
                    <th colspan="1"> @NombreMeses[mes - 1]</th>

                }
            </tr>
            <tr>
                @foreach (var mes in Meses)
                {
                    @*<th style="width:80px !important;">Pres. $</th>*@
                    <th style="width:80px !important;">Real $</th>
                    @*<th style="width:80px !important;"> Desv. $</th>
                    <th style="width:80px !important;"> Desv. %</th>*@


                }
            </tr>

            <tr style="background-color: silver; text-align: left">
                <th>INGRESOS</th>
            </tr>

            <tr style=";">
                <th style="background-color: silver; text-align: left">1. Subvención</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
       //             double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 3)).Sum(m => m.Monto);
         //           double valorDif = valorIngresos - valorPresupuesto;
           //         double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                   

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
             //               totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  


                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">2. Sobreatenciones/Interv. 80 bis</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
               //     double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 5)).Sum(m => m.Monto);
                 //   double valorDif = valorIngresos - valorPresupuesto;
                  //  double valorDifPor = (valorDif) / (valorPresupuesto) * 100;

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                    //        totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                   
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                       
                            { foreach (var meses in Meses)
                                {

                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 5) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }

                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                      
                    }*@

                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">3. Anticipo Subvención</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                   // double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 4)).Sum(m => m.Monto);
                   // double valorDif = valorIngresos - valorPresupuesto;
                   // double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                  

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                     //       totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                   
                    @*if (mes == 12 && mesSeleccion == 15 || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 4) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 4) && p.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }

                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                    }*@
                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">4. Otros Aportes del SENAME</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    //double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 8 && p.CuentaID == 10)).Sum(m => m.Monto);
                    //double valorDif = valorIngresos - valorPresupuesto;
                    //double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                   
                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                      //      totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                       {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 8 && m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 8 && p.CuentaID == 10) && p.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                        
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                    }*@
                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">5. Otros Ingresos</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    //double valorPresupuesto = @presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 12 && p.CuentaID == 14)).Sum(m => m.Monto);
                    //double valorDif = valorIngresos - valorPresupuesto;
                    //double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                      //      totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13) || (mes == 12 && mesSeleccion == 15))
                    {
                       {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 12 && m.CuentaID == 14) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(p => (p.CuentaID == 12 && p.CuentaID == 14) && p.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                       
                    }*@
                
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>INGRESOS</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    //double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10)).Sum(m => m.Monto);
                    //double valorDif = valorIngresos - valorPresupuesto;
                    //double valorDifPor = (valorDif) / (valorPresupuesto) * 100;

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                      //      totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8 || m.CuentaID == 12 || m.CuentaID == 10) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Egresos</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1. Personal</th>
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">a. Remuneraciones</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    //double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    //double DifEgresos = (valorEgresos - valorReintegro) - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    valorEgresos = valorEgresos - valorReintegro;

                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorEgresos;
                            //totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                   
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                       { foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163) && m.Mes == meses).Sum(m => m.Monto);
                                }
                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }

                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                    }*@
                }
            </tr>
            <tr style="">
                <th style="background-color: silver; text-align: left">b. Próvision de Fondos para Indemnizaciones</th>
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    //double valorPresupuesto = @presupuestoDetalle.Where(m => m.Mes == mes && (m.CuentaID == 41)).Sum(m => m.Monto);
                    //double valorDif = valorIngresos - valorPresupuesto;
                    //double valorDifPor = (valorDif) / (valorPresupuesto) * 100;
                  

                    <td>
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                      //      totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                   
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                       {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }

                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>                
                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Personal</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    //double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    //double DifEgresos = (valorEgresos - valorReintegro) - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    valorEgresos = valorEgresos - valorReintegro;
                 <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorEgresos;
                            //totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        {
                                foreach (var meses in Meses)
                                {
                                    valorIngresos += ingresos.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Temporal == null && m.Periodo == periodo && m.Mes == meses).Sum(m => m.Monto_Ingresos);
                                    valorPresupuesto += @presupuestoDetalle.Where(m => (m.CuentaID == 22 || m.CuentaID == 23 || m.CuentaID == 25 || m.CuentaID == 26 || m.CuentaID == 27 || m.CuentaID == 28 || m.CuentaID == 163 || m.CuentaID == 41) && m.Mes == meses).Sum(m => m.Monto);
                                }


                                valorDif = valorIngresos - valorPresupuesto;
                                valorDifPor = (valorDif) / (valorPresupuesto) * 100; }
                        <td>
                            @( (valorIngresos).ToString("$#,###"))
                        </td>
                      
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2. Operación</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">a. Funcionamiento</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Consumos Básicos</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                     
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Arriendo Inmueble</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 44)).Sum(m => m.Monto);
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 44)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 44)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
   
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Materiales de Escritorio y Aseo</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123)).Sum(m => m.Monto);
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 125 || e.CuentaID == 123)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 125 || e.CuentaID == 123)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 

                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">4) Mantención y Reparaciones</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49)).Sum(m => m.Monto);
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 48 || e.CuentaID == 49)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                  
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 48 || e.CuentaID == 49) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Servicios Generales </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                       
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>                      
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">6) Caja Chica y Fondos a Rendir</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 60 || e.CuentaID == 61)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && e.Egreso.Mes == meses && (e.CuentaID == 60 || e.CuentaID == 61)).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 60 || e.CuentaID == 61) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">7) Aportes a la Administración Central</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 64)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 64)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 64)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 64) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 64) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">8) Devolución de fondos al SENAME</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 145)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 145)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 145)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 145) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 145) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                                        double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 64)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;

                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Funcionamiento</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                     
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">b. Apoyo Técnico</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Alimentación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 66)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 66)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
      
                  
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Autocuidado</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 146)).Sum(m => m.Monto);
                    //double valorPresupuestoE = 0;// presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 146)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 146)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
   
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Capacitación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 68)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 68)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 68)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 68) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 68) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                       
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">4) Materiales e Insumos Técnicos</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 69)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 69)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 69)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                   
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 69) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 69) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Movilización</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                   // double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 70)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>

                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                        valorPresupuestoE = presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 70)).Sum(m => m.Monto);
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th >Total Apoyo Técnico</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70) && e.Mes == meses).Sum(m => m.Monto);
                        }


                        DifEgresos = valorEgresos - valorPresupuestoE;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">
                    c. Apoyo Beneficiario
                </th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">1) Alimentación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 72)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 72)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
               
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                     
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">2) Ayuda a las Familias</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 73)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 73)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 73)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {

                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 73) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 73) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">3) Capacitación y Educación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 74 || e.CuentaID == 76)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                    //        totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                  
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 74 || e.CuentaID == 76) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 4) Deportes y Recreación </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 75)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 75)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                 
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 75)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                     <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                      //          totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                    </td>

                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 75) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 75) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                                {
                                    totalIngresosEgreso[mes] += valorEgresos;
                                    totalPresupuestoE[mes] += valorPresupuestoE;
                                }
                            }
                            else
                            {@Html.Raw("$0")}
                        </td>

                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">5) Movilización </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 77)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 77)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 77)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 77) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 77) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">6) Salud e Higiene </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 78)).Sum(m => m.Monto);
                 //   double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 78)).Sum(m => m.Monto);
                  //  double DifEgresos = valorEgresos - valorPresupuestoE;
                   // double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 78)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                     //       totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
               
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 78) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 78) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 7) Vestuario y Calzador</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 79)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 79)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>

                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
            {
                foreach (var meses in Meses)
                {
                    valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                    valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                }


                DifEgresos = valorEgresos - valorPresupuestoE;
                DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                <td>
                    @if (valorEgresos != 0)
                    {@valorEgresos.ToString("$#,###")
                    {
                        totalIngresosEgreso[mes] += valorEgresos;
                        totalPresupuestoE[mes] += valorPresupuestoE;
                    }
                }
                else
                {@Html.Raw("$0")}
                </td>
            }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th> Total Apoyo Beneficiario </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    double valorReintegro = double.Parse(reintegros.Where(e => (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valorReintegro;
                    
                      <td>

                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>

                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th> Total Operación</th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valor_Reintegros;
                    //double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
             
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 50 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 59 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 71 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    
                    }*@
             }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> 3. Inversión </th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> a. Equipamiento </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104)).Sum(m => m.Monto);
                   // double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104)).Sum(m => m.Monto);
                   // double DifEgresos = valorEgresos - valorPresupuestoE;
                   // double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                     //       totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
              
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> b. Infraestructura </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 43)).Sum(m => m.Monto);
                    //double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 43)).Sum(m => m.Monto);
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                      
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th> Total Operación </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Sum(m => m.Monto);
                   // double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Sum(m => m.Monto);
                   // double DifEgresos = valorEgresos - valorPresupuestoE;
                   // double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                 
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                      //      totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 6 && mesSeleccion == 13) || (mes == 12 && mesSeleccion == 14))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                    
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Egresos</th>
                @foreach (var mes in Meses)
                {   //valorIngresos
                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                 //   double valorPresupuesto = double.Parse(@presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());

                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    double valorReintegroPersonal = double.Parse(reintegros.Where(e => (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());

                    double valor_ReintegrosOperacion = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_Reintegros = valorReintegroPersonal + valor_ReintegrosOperacion;
                    valorEgresos = valorEgresos - valor_Reintegros;
                   // double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                   // double DifEgresos = valorEgresos - valorPresupuestoE;
                   // double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                 //   double valorDif = valorEgresos - valorPresupuesto;
                  //  double valorDifPor = (valorDif) / (valorPresupuesto) * 100;

                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                    //        totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
              
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorIngresos += ingresos.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto += @presupuestoDetalle.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);

                            //valorEgresos
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        valorDif = valorEgresos - valorPresupuesto;
                 

                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                //   totalIngresosEgreso[mes] += valorIngresos;
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                 
                    }*@

                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th >Resultado</th>
                @foreach (var mes in Meses)
                {   //valorIngresos
                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                    //double valorPresupuesto = double.Parse(@presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12)).Sum(m => m.Monto).ToString());

                    //valorEgresos
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    valorEgresos = valorEgresos - valor_Reintegros;
                    //double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    //double DifEgresos = valorEgresos - valorPresupuestoE;
                    //double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                  //  double valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                  //  double valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;
              

                    <td>
                        @if (valorIngresos - valorEgresos != 0)
                        {@((valorIngresos - valorEgresos).ToString("$#,###"))
                        {
                            //   totalIngresosEgreso[mes] += valorIngresos;
                            totalesIngresos[mes] += valorIngresos;
                    //        totalesPresupuestosIngresos[mes] += valorPresupuesto;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
             
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorIngresos += ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorPresupuesto += @presupuestoDetalle.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Mes == meses).Sum(m => m.Monto);

                            //valorEgresos
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                        valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                        valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;
                    

                        <td>
                            @if (valorIngresos - valorEgresos != 0)
                            {@((valorIngresos - valorEgresos).ToString("$#,###"))
                            {
                                //   totalIngresosEgreso[mes] += valorIngresos;
                                totalesIngresos[mes] += valorIngresos;
                                totalesPresupuestosIngresos[mes] += valorPresupuesto;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
            
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Financimiento </th>
            </tr>
            <tr style="background-color: silver; text-align: left">

            <th align="left">SALDO INICIAL</th>
  
            @{
            var i = 1;
            var SSaldo = ViewBag.SaldoInicial;
             foreach (var mes in Meses)           
             {
                 int tope = int.Parse(mes.ToString());
                 if (i != mes) {
                     saldoInicial[1] = SSaldo;
                     int j = 1;
                     while (j < tope)
                     {
                         double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == j && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                       //valorEgresos
                         double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == j && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                         double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == j).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                         valorEgresos = valorEgresos - valor_Reintegros;
                         SSaldo = valorIngresos - valorEgresos + SSaldo;
                         j++;
                         saldoInicial[j] = SSaldo;
                   
                     }
                 }
                  
                <td class="num"> @SSaldo.ToString("$#,###")</td>
          
            }
            }         
        </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Prestamos y Traspasos Institucionales y Programas </th>
                @foreach (var mes in Meses)
                {

                    double valorIngresos = ingresos.Where(e => (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos);

                    double valorEgresos = egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto);
                  //  double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto);
                   // double valorPresupuesto = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158)).Sum(m => m.Monto);
                 //   double DifEgresos = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                 //   double DifEgresosPor = (DifEgresos / (valorPresupuesto - valorPresupuestoE)) * 100;
            
                    <td>
                        @if ((valorIngresos - valorEgresos) != 0)
                        {@((valorIngresos - valorEgresos).ToString("$#,###"))
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                   //         totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>
                 
                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        double ValorIngresos = 0;
                        foreach (var meses in Meses)
                        {
                            ValorIngresos += ingresos.Where(e => (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Temporal == null && e.Periodo == periodo && e.Mes == meses).Sum(m => m.Monto_Ingresos);
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 40 || e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159) && e.Mes == meses).Sum(m => m.Monto);
                            valorPresupuesto += presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 10 || e.CuentaID == 14 || e.CuentaID == 16 || e.CuentaID == 17 || e.CuentaID == 18 || e.CuentaID == 158) && e.Mes == meses).Sum(m => m.Monto);
                        }
                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                   
                        <td>
                            @if ((ValorIngresos - valorEgresos) != 0)
                            {@((ValorIngresos - valorEgresos).ToString("$#,###"))
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                    }*@
                }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Aportes Institucionales </th>
                @foreach (var mes in Meses)
                {
                    double valorEgresos = ingresos.Where(e => e.Temporal == null && e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 20)).Sum(m => m.Monto_Ingresos);
                   // double valorPresupuestoE = presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 20)).Sum(m => m.Monto);
                   // double DifEgresos = valorEgresos - valorPresupuestoE;
                   // double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                  
                    <td>
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")
                        {
                            totalIngresosEgreso[mes] += valorEgresos;
                     //       totalPresupuestoE[mes] += valorPresupuestoE;
                        }
                    }
                    else
                    {@Html.Raw("$0")}
                    </td>

                    @*if ((mes == 12 && mesSeleccion == 15) || (mes == 12 && mesSeleccion == 14) || (mes == 6 && mesSeleccion == 13))
                    {
                        foreach (var meses in Meses)
                        {
                            valorEgresos += egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Egreso.Mes == meses).Sum(m => m.Monto);
                            valorPresupuestoE += presupuestoDetalle.Where(e => e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43) && e.Mes == meses).Sum(m => m.Monto);
                        }

                        DifEgresos = valorEgresos - valorPresupuestoE;
                        DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;
                
                        <td>
                            @if (valorEgresos != 0)
                            {@valorEgresos.ToString("$#,###")
                            {
                                totalIngresosEgreso[mes] += valorEgresos;
                                totalPresupuestoE[mes] += valorPresupuestoE;
                            }
                        }
                        else
                        {@Html.Raw("$0")}
                        </td>
                  
                    }*@
                }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th >Saldo Final</th>
 @foreach (var mes in Meses)
                                {
                                    //saldoInicial[mes] = 0;
                                    presupuestoInicial[mes] = 0;
                                    //valorIngresos
                                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                       //             double valorPresupuesto = double.Parse(@presupuestoDetalle.Where(e => e.Mes == mes && (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12)).Sum(m => m.Monto).ToString());
                                    valorIngresos += double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 17 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    valorIngresos -= double.Parse(ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                         //           valorPresupuesto += double.Parse(@presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 10 || p.CuentaID == 14 || p.CuentaID == 16 || p.CuentaID == 17 || p.CuentaID == 17 || p.CuentaID == 158 || p.CuentaID == 20)).Sum(m => m.Monto).ToString());
                           //         valorPresupuesto -= double.Parse(@presupuestoDetalle.Where(p => p.Mes == mes && (p.CuentaID == 40 || p.CuentaID == 63 || p.CuentaID == 155 || p.CuentaID == 156 || p.CuentaID == 157)).Sum(m => m.Monto).ToString());

                                    //valorEgresos
                                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresos = valorEgresos - valor_Reintegros;

                             //       double valorPresupuestoE = double.Parse(presupuestoDetalle.Where(e => e.Mes == mes && e.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                              //      double DifEgresos = valorEgresos - valorPresupuestoE;
                               //     double DifEgresosPor = (DifEgresos / valorPresupuestoE) * 100;

                                //    double valorDif = (valorIngresos - valorEgresos) - (valorPresupuesto - valorPresupuestoE);
                                //    double valorDifPor = (valorDif) / (valorPresupuesto - valorPresupuestoE) * 100;


      
                                    <td style="background-color: silver; text-align: right ">
                                        @if (valorIngresos - valorEgresos != 0 && mes == 1)
                                        {
                                            //saldoInicial[mes] = double.Parse((@db.Presupuesto.Where(p => p.Proyecto.ID == id && p.Periodo == periodo).Sum(s => s.SaldoInicial)).ToString());
                                            @((saldoInicial[mes] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                                            { saldoInicial[mes] = double.Parse(((@db.Presupuesto.Where(p => p.Proyecto.ID == id && p.Periodo == periodo).Sum(s => s.SaldoInicial)) + Convert.ToInt32(valorIngresos - valorEgresos)).ToString()); }
                                            {
                                                totalesIngresos[mes] += valorIngresos;
                                  //              totalesPresupuestosIngresos[mes] += valorPresupuesto;
                                            }
                                        }
                                        else
                                        {
                                            @((saldoInicial[mes] + (valorIngresos - valorEgresos)).ToString("$#,###"))
                                         
                                        }
                                    </td>

                                { valorIngresos = 0; valorEgresos = 0; }


    
                                    }
                


            </tr>

        </table>
    </div>
     }catch{
        
    }
    }
        catch (Exception)
        {
 
        }
}


