@model SAG2.Models.Informe
@{
    ViewBag.Title = "Reporte Programa Estandar";
    Layout = "~/Views/Shared/_Layoutinf.cshtml";
    SAG2.Models.SAG2DB db = new SAG2.Models.SAG2DB();
    var MesesData = new string[12]
    {
        "Enero",
        "Febrero",
        "Marzo",
        "Abril",
        "Mayo",
        "Junio",
        "Julio",
        "Agosto",
        "Septiembre",
        "Octubre",
        "Noviembre",
        "Diciembre"
    };

}

<script type="text/javascript">
    $(document).ready(function () {
        $(".js-autocomplete").select2();
    });
</script>
<style media="print">
    @@page {
        size: landscape;
        margin: 1cm !important;
    }

    body {
        font-family: "Times New Roman" !important;
        margin: 0 !important;
        display: block !important;
        overflow: visible !important;
    }

    td {
        font-size: 10px !important;
    }

    th {
        font-size: 12px !important;
    }

    h2 {
        font-size: 16px !important;
        text-align: center;
    }

    .pie {
        display: none;
    }

    .permisos, .body, .contenedor {
        padding: 0 !important;
        border: 0 !important;
        display: block !important;
    }

    .permisos {
        width: 90% !important;
    }

    .ocultoImpresion, .menu, .top {
        display: none;
    }

    .soloImpresion {
        display: block;
    }

    .DatosPresupuesto {
        overflow: visible !important;
        display: block !important;
    }

    th {
        font-size: 11px !important;
    }
</style>
<style media="screen">
    th {
        font-size: 11px !important;
    }
</style>

@using (Html.BeginForm())
{
   <h2><i class="fa fa-file-text-o"></i> Reporte Estandar por Programa</h2>

    <hr />
    @Html.ValidationSummary(false, "", new { @class = "text-danger" })

    <div class="row">
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
            <label class="control-label" for="Programas">Programas</label>
            @Html.DropDownList("Proyectos", null, htmlAttributes: new { @class = "form-control js-autocomplete" })
        </div>
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
           <label class="control-label" for="Mes">Mes</label>  
                    	    <select class="form-control" name="Mes" id="Mes">
                                @for (var i = 0; i < 12; i++)
                                {
                                    <option value="@Html.Raw((@i + 1).ToString())"@if (@ViewBag.mes == (i + 1))
                                                                                  {@Html.Raw("selected=\"selected\"")}>@Html.Raw(@MesesData[@i])</option>
                                }
                                <option value="13" @if (@ViewBag.mes == 13)
                                                   {@Html.Raw("selected=\"selected\"")}>Primer Semestre</option>
                                <option value="14" @if (@ViewBag.mes == 14)
                                                   {@Html.Raw("selected=\"selected\"")}>Segundo Semestre</option>
                                 <option value="15" @if (@ViewBag.mes == 15)
                                                    {@Html.Raw("selected=\"selected\"")}>Anual</option>
                               </select>    
        </div>
        <div class="col-md-4 col-lg-4 col-sm-6 col-xs-6">
            <label class="control-label" for="Periodo">Año</label>
                         <select class="form-control" name="Periodo" id="Periodo">
                            @for (var i = DateTime.Now.Year - 3; i <= DateTime.Now.Year + 1; i++)
                            {
                                <option value="@Html.Raw((@i).ToString())" @if (@ViewBag.periodo == i)
                                                                           {@Html.Raw("selected=\"selected\"")}>@Html.Raw((@i).ToString())</option>
                            }
                            </select>
        </div>
    </div>
    <br/>
    <div class="row">
    <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 centrado">
        <input type="submit" name="ReportePrograma" value="Procesar" class="btn btn-primary" />
        @if (ViewBag.ID != null)
        {  
        @Html.ActionLink("Excel", "ReporteProgramaEstandarExcel", "Informe", new { Informe = ViewBag.IdInforme, Proyectos = ViewBag.ID, Mes = ViewBag.Mes, periodo = ViewBag.Periodo }, new { @class = "btn btn-success" })
        }
    </div>
    </div>
    <hr/>
}
@if (ViewBag.entrada == 2)
{
    // Cambiar
    //try
    //{
    int mesSeleccion = ViewBag.Mes;
    var Meses = ViewBag.GrupoMeses;
    var NombreMeses = new string[12]
    {
"Ene.",
"Feb.",
"Mar.",
"Abr.",
"May.",
"Jun.",
"Jul.",
"Ago.",
"Sep.",
"Oct.",
"Nov.",
"Dic."
    };
    //List<SAG2.Models.Cuenta> cuentas = new List<SAG2.Models.Cuenta>();
    try
    {



        int id = ViewBag.ID;
        int periodo = ViewBag.Periodo;

        List<SAG2.Models.Movimiento> ingresos = ViewBag.ingresos;
        List<SAG2.Models.DetalleEgreso> egresos = ViewBag.egresos;
        List<SAG2.Models.Movimiento> reintegros = ViewBag.reintegros;
        List<SAG2.Models.DetalleReintegro> reintegrosGastos = ViewBag.reintegrosGastos;

        var totalEgreso = new double[13];
        var totalPresupuestoE = new double[13];
        var totalIngresosEgreso = new double[13];
        var totalesIngresos = new double[13];
        var totalesEgresos = new double[13];
        var TotalesREstandar = new double[26];


        var saldoInicial = new double[13];

        double xTotSename = 0;
        foreach (var mes in Meses)
        {
            double valorIngresos = ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
            xTotSename += valorIngresos;


        }
        TotalesREstandar[3] = xTotSename;
        // Aqui


    <div class="col-md-12" style="overflow-y: scroll;" id="prueba ocultoImpresion">
        <table border="1" class="table table-bordered table-hover">
            <tr>
                <tH>Estado de Resultado</tH>
                @if (@ViewBag.Mes == 13 || @ViewBag.Mes == 14)
                {
                <tH colspan="7">@db.Proyecto.Find(id).NombreLista</tH>
                }
                @if (@ViewBag.Mes == 15)
                {
                <tH colspan="13">@db.Proyecto.Find(id).NombreLista</tH>
                }
                 @if (@ViewBag.Mes < 13)
                 {
                <tH >@db.Proyecto.Find(id).NombreLista</tH>
                 }
            </tr>
            <tr>

                <th rowspan="2">CONCEPTO</th>
                @foreach (var mes in Meses)
                {
                    <th colspan="1"> @NombreMeses[mes - 1]</th>

                }
            </tr>
            <tr>
                @foreach (var mes in Meses)
                {
                    
                    <th style="width:80px !important;">Real $</th>
                }
                  @if (@ViewBag.Mes > 12)
                  { 
                    <th colspan="1"> Total</th>
                  } 
            </tr>

         
         <tr style="background-color: yellow; text-align: left">

            <th align="left">SALDO INICIAL</th>
             @{
                  var i = 1;
                  double xTotalSaldo = 0;
                  var xSSaldo = ViewBag.SaldoInicial;
                  double SSaldo = xSSaldo;
                  foreach (var mes in Meses)
                  {
                      int tope = int.Parse(mes.ToString());
                      if (i != mes)
                      {
                          SSaldo = xSSaldo;
                          saldoInicial[1] = SSaldo;
                          int j = 1;
                          while (j < tope)
                          {
                              double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == j && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                              double valorIngresos2 = double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 19 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == j && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                              double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == j && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 40)).Sum(m => m.Monto).ToString());
                              double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == j).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                              double valorEgresosE = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == j && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                              double valor_ReintegrosE = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Mes == j).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                              valorEgresosE = valorEgresosE - valor_ReintegrosE;
                              valorEgresos = valorEgresos - valor_Reintegros;
                              SSaldo = (valorIngresos + valorIngresos2) - valorEgresos + SSaldo - valorEgresosE;
                              j++;


                          }
                      }
                  
                <td style="text-align: right;font-weight: bold;color:blue;">
                   
                               @if (SSaldo != 0)
                               {
                                                 @SSaldo.ToString("$#,###")
                               }
                               else
                               {@Html.Raw("$0")}

                </td>
                
                               saldoInicial[mes] = SSaldo;

                  }
                  if (@ViewBag.Mes > 12)
                  { 
                    double PSename = (saldoInicial[1] / TotalesREstandar[3])*100;
                        <th style="text-align: right;font-weight: bold;color:blue;"> @saldoInicial[1].ToString("$#,###")</th>
                   <th style="text-align: right;font-weight: bold;color:blue;"> @PSename.ToString("#.##") %</th>
                }
             }    
        
        </tr>
               <tr style="background-color: silver; text-align: left">
                <th>INGRESOS</th>
            </tr>
            <tr style=";">

                <th style="text-align: left"> Subvenci&oacute;n</th>
                 @{ 
                  double xTot1 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xTot1 += valorIngresos;
                   

                    <td style=" text-align: right; font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")
              
                        }
                        else
                        {@Html.Raw("$0")}
                    </td>
                  

                }

                  @if (@ViewBag.Mes > 12)
                  {
                      TotalesREstandar[0] = xTot1;
                      double PSename = (xTot1 / TotalesREstandar[3])*100;
                        
                     <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot1 != 0)
                       { @xTot1.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                        <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot1 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    % </th>
                  } 
            </tr>
            <tr style="">
                <th style="text-align: left"> Sobreatenciones</th>
                @{ 
                  double xTot2 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 5) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xTot2 += valorIngresos;

                    <td style=" text-align: right; font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")

                        }
                        else
                        {@Html.Raw("$0")}
                    </td>                  
                }
                 @if (@ViewBag.Mes > 12)
                 { 
                      TotalesREstandar[1] = xTot2;
                      double PSename = (xTot2 / TotalesREstandar[3])*100;

                     <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot2 != 0)
                       { @xTot2.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                       <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot2 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                 } 

            </tr>

            <tr style="">
                <th style="text-align: left"> Bonos Aguinaldos</th>
                 @{ 
                 double xTot4 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 8) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xTot4 += valorIngresos;
                   
                    <td style=" text-align: right; font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")

                        }
                        else
                        {@Html.Raw("$0")}
                    </td>
                  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                      TotalesREstandar[2] = xTot4;
                      double PSename = (xTot4 / TotalesREstandar[3])*100;

                     <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot4 != 0)
                       { @xTot4.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                    <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot4 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    } 
            </tr>

            <tr style="background-color: silver; text-align: left">
                <th>Total Ingr. Sename</th>
                 @{ 
                    double xTot6 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 3 || m.CuentaID == 4 || m.CuentaID == 5 || m.CuentaID == 8) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xTot6 += valorIngresos; 

                    <td style="background-color: silver; text-align: right; font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>                  
                }
                  @if (@ViewBag.Mes > 12)
                  { 
                     <th style="background-color: silver; text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTot6 != 0)
                       { @xTot6.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                    <th> 100 %</th>
                  }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Egresos</th>
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Personal</th>
            </tr>
            <tr style="">
                <th style="text-align: left">Remuneraciones</th>
                 @{ 
                  double xRem = 0;
                }
                @foreach (var mes in Meses)
                {

                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 22 || e.CuentaIDD == 23 || e.CuentaIDD == 25 || e.CuentaIDD == 26 || e.CuentaIDD == 27 || e.CuentaIDD == 28 || e.CuentaIDD == 163)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xRem += valorEgresos;
                    
                    <td style="text-align: right; font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>
                   
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[4] = xRem;					  
                        double PSename = (xRem / TotalesREstandar[3])*100;

                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xRem != 0)
                       { @xRem.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>  
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xRem != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>
            <tr style="">
                <th style=" text-align: left">Pr&oacute;vision de Fondos para Indemnizaciones</th>
                   @{ 
                    double xProv = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 41)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 41)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;


                    xProv += valorEgresos; 
                  

                    <td style="text-align: right; font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>
                }
                  @if (@ViewBag.Mes > 12)
                  { 
                    TotalesREstandar[5] = xProv;					  
                    double PSename = (xProv / TotalesREstandar[3])*100;

                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xProv != 0)
                      { @xProv.ToString("#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xProv != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    %</th>
                  }
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th>Total Personal</th>
                   @{ 
                  double xPer = 0;
                }
                @foreach (var mes in Meses)
                {

                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 22 || e.CuentaIDD == 23 || e.CuentaIDD == 25 || e.CuentaIDD == 26 || e.CuentaIDD == 27 || e.CuentaIDD == 28 || e.CuentaIDD == 163 || e.CuentaIDD == 41)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xPer += valorEgresos;
                     
                 <td style="text-align: right; font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>
                  
                }
                  @if (@ViewBag.Mes > 12)
                  { 
                    TotalesREstandar[6] = xPer;					  
                    double PSename = (xPer / TotalesREstandar[3])*100;

                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xPer != 0)
                       { @xPer.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xPer != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    %</th>
                  }
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left">Operaci&oacute;n</th>
            </tr>

            <tr>
                <th style="text-align: left">Funcionamiento</th>
                 @{ 
                  double xCB = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 125 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 61 || e.CuentaID == 62 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 125 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 61 || e.CuentaID == 62 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 33 || e.CuentaIDD == 34 || e.CuentaIDD == 35 || e.CuentaIDD == 36 || e.CuentaIDD == 44 || e.CuentaIDD == 123 || e.CuentaIDD == 125 || e.CuentaIDD == 48 || e.CuentaIDD == 49 || e.CuentaIDD == 52 || e.CuentaIDD == 150 || e.CuentaIDD == 151 || e.CuentaIDD == 153 || e.CuentaIDD == 154 || e.CuentaIDD == 53 || e.CuentaIDD == 54 || e.CuentaIDD == 55 || e.CuentaIDD == 56 || e.CuentaIDD == 57 || e.CuentaIDD == 58 || e.CuentaIDD == 147 || e.CuentaIDD == 149 || e.CuentaIDD == 61 || e.CuentaIDD == 62 || e.CuentaIDD == 64 || e.CuentaIDD == 145 || e.CuentaIDD == 44 || e.CuentaIDD == 123 || e.CuentaIDD == 50 || e.CuentaIDD == 59 || e.CuentaIDD == 60)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xCB += valorEgresos; 
                    <td style="text-align: right; font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>
                }
                   @if (@ViewBag.Mes > 12)
                   { 
                    TotalesREstandar[7] = xCB;					  
                    double PSename = (xCB / TotalesREstandar[3])*100;
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xCB != 0)
                       { @xCB.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xCB != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    %</th>
                   }
            </tr>
            <tr>
                <th style="text-align: left">Ap T&eacute;cnico</th>
                   @{ 
                   double xAI = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 66 || e.CuentaIDD == 146 || e.CuentaIDD == 68 || e.CuentaIDD == 69 || e.CuentaIDD == 70)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xAI += valorEgresos; 
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[8] = xAI;					  
                        double PSename = (xAI / TotalesREstandar[3])*100;
                      <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI != 0)
                       { @xAI.ToString("$#,###") }
                       else
                       {@Html.Raw("0")}
                    </th>
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>
            <tr>
            <th style="text-align: left">Ap. Beneficiarios</th>
                      @{ 
                    double xTTEgreso3 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 72 || e.CuentaIDD == 73 || e.CuentaIDD == 74 || e.CuentaIDD == 75 || e.CuentaIDD == 76 || e.CuentaIDD == 77 || e.CuentaIDD == 78 || e.CuentaIDD == 79)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xTTEgreso3 += valorEgresos; 
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>                
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[9] = xTTEgreso3;					  
                        double PSename = (xTTEgreso3 / TotalesREstandar[3])*100;
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTTEgreso3 != 0)
                       { @xTTEgreso3.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                       <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTTEgreso3 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>




            <tr style="background-color: silver; text-align: left">
                <th>Total Operaci&oacute;n</th>
                @{
                    double xTotalOperaciones = 0;
                    }
                 @foreach (var mes in Meses)
                 {
                     double valorEgresos = 0;
                     double valorEgresosF = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 125 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 61 || e.CuentaID == 62 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60)).Sum(m => m.Monto).ToString());
                     double valor_ReintegrosF = double.Parse(reintegros.Where(e => (e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 125 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 61 || e.CuentaID == 62 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 44 || e.CuentaID == 123 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                     double valor_GastosReintegrosF = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 33 || e.CuentaIDD == 34 || e.CuentaIDD == 35 || e.CuentaIDD == 36 || e.CuentaIDD == 44 || e.CuentaIDD == 123 || e.CuentaIDD == 125 || e.CuentaIDD == 48 || e.CuentaIDD == 49 || e.CuentaIDD == 52 || e.CuentaIDD == 150 || e.CuentaIDD == 151 || e.CuentaIDD == 153 || e.CuentaIDD == 154 || e.CuentaIDD == 53 || e.CuentaIDD == 54 || e.CuentaIDD == 55 || e.CuentaIDD == 56 || e.CuentaIDD == 57 || e.CuentaIDD == 58 || e.CuentaIDD == 147 || e.CuentaIDD == 149 || e.CuentaIDD == 61 || e.CuentaIDD == 62 || e.CuentaIDD == 64 || e.CuentaIDD == 145 || e.CuentaIDD == 44 || e.CuentaIDD == 123 || e.CuentaIDD == 50 || e.CuentaIDD == 59 || e.CuentaIDD == 60)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                     valorEgresosF = (valorEgresosF + valor_GastosReintegrosF) - valor_ReintegrosF;


                     double valorEgresosAT = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Sum(m => m.Monto).ToString());
                     double valor_ReintegrosAT = double.Parse(reintegros.Where(e => (e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                     double valor_GastosReintegrosAT = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 66 || e.CuentaIDD == 146 || e.CuentaIDD == 68 || e.CuentaIDD == 69 || e.CuentaIDD == 70)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                     valorEgresosAT = (valorEgresosAT + valor_GastosReintegrosAT) - valor_ReintegrosAT;



                     double valorEgresosAB = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                     double valor_ReintegrosAB = double.Parse(reintegros.Where(e => (e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 75 || e.CuentaID == 76 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                     double valor_GastosReintegrosAB = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 72 || e.CuentaIDD == 73 || e.CuentaIDD == 74 || e.CuentaIDD == 75 || e.CuentaIDD == 76 || e.CuentaIDD == 77 || e.CuentaIDD == 78 || e.CuentaIDD == 79)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                     valorEgresosAB = (valorEgresosAB + valor_GastosReintegrosAB) - valor_ReintegrosAB;

                     valorEgresos = valorEgresosF + valorEgresosAT + valorEgresosAB;
                     xTotalOperaciones += valorEgresos; 
                    <td style="text-align: right; font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>                
                 }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[10] = xTotalOperaciones;					  
                        double PSename = (xTotalOperaciones / TotalesREstandar[3])*100;   
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotalOperaciones != 0)
                       { @xTotalOperaciones.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotalOperaciones != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    %</th>
                    }

                            
            </tr>
  


            <tr>
                <th style="background-color: silver; text-align: left">Inversi&oacute;n</th>
                @{ 
                    double xTinvEgreso1 = 0;// voy aqui
                }
                @foreach (var mes in Meses)
                {

                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 127 || e.CuentaIDD == 101 || e.CuentaIDD == 102 || e.CuentaIDD == 104 || e.CuentaIDD == 43)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xTinvEgreso1 += valorEgresos;
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###") }
                        else
                        {@Html.Raw("$0")}
                    </td>
              
 
                }
                     @if (@ViewBag.Mes > 12)
                     { 
                         TotalesREstandar[11] = xTinvEgreso1;					  
                        double PSename = (xTinvEgreso1 / TotalesREstandar[3])*100;  
                                <th style="background-color: silver; text-align: right; font-weight: bold;color:blue;">  
                                    @if (xTinvEgreso1 != 0)
                                    {
                                     @xTinvEgreso1.ToString("$#,###")
                                    }
                                    else
                                    {@Html.Raw("$0")}
                                </th>
                            <th style="background-color: silver; text-align: right; font-weight: bold;color:blue;">  
                                    @if (xTinvEgreso1 != 0)
                                    {
                                     { @PSename.ToString("#.##") }
                                    }
                                    else
                                    {@Html.Raw("0")}
                                %</th>
                     } 
            </tr>

   
            <tr style="background-color: silver; text-align: left">
                <th>Total Egresos</th>
                                 @{
                     double xTotegreso = 0;
                                }
                                @foreach (var mes in Meses)
                                {   //valorIngresos

                                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresos = valorEgresos - valor_Reintegros;

                                    <td style="background-color: silver;text-align: right; font-weight: bold;color:blue;">
                                        @if (valorEgresos != 0)
                                        {@valorEgresos.ToString("$#,###")
                                            xTotegreso += valorEgresos;
                                        }
                                        else
                                        {@Html.Raw("$0")}
                                    </td>
  
                                }
                                 @if (@ViewBag.Mes > 12)
                                 { 
                                     TotalesREstandar[12] = xTotegreso;					  
                                double PSename = (xTotegreso / TotalesREstandar[3])*100;  
                                <th style="background-color: silver; text-align: right; font-weight: bold;color:blue;">  
                                      @if (xTotegreso != 0)
                                      {
                                    @xTotegreso.ToString("$#,###") 
                                      }
                                      else
                                      {@Html.Raw("$0")}
                                </th>
                                  <th style="background-color: silver; text-align: right; font-weight: bold;color:blue;">  
                                      @if (xTotegreso != 0)
                                      
                                         { @PSename.ToString("#.##") }
                                      
                                      else
                                      {@Html.Raw("$0")}
                                %</th>
                                 } 
            </tr>
            <tr style="background-color: silver; text-align: left">
                <th >Resultado</th>
                                               @{
                                 double xTotflujo = 0;
                                }
                                @foreach (var mes in Meses)
                                {   //valorIngresos


                                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresos = valorEgresos - valor_Reintegros;
                                    double TotalFlujo = valorIngresos - valorEgresos;
                                    xTotflujo += TotalFlujo;
                                    if (TotalFlujo >= 0)
                                    {
                                    <td style=" background-color: silver;text-align: right; font-weight: bold;color:blue; ">
                                        @if (TotalFlujo != 0)
                                        {
                                             
                                            @(TotalFlujo.ToString("$#,###"))                          
                                        }
                                        else
                                        {@Html.Raw("$0")}
                                    </td>
                                    }
                                    else
                                    {
                                      <td style=" background-color: silver;text-align: right; font-weight: bold;color:red ">
                                        @if (TotalFlujo != 0)
                                        {
                                             
                                            @(TotalFlujo.ToString("$#,###"))                          
                                        }
                                        else
                                        {@Html.Raw("$0")}
                                    </td>
                                    
                                    }

                                }
                                @if (@ViewBag.Mes > 12)
                                { 
                                    TotalesREstandar[13] = xTotflujo;					  
                                    double PSename = (xTotflujo / TotalesREstandar[3])*100;  
                                <th style="background-color: silver;text-align: right; font-weight: bold;color:blue; ">  
                                    @if (xTotflujo != 0)
                                    {
                                     @xTotflujo.ToString("$#,###")
                                    }
                                    else
                                    {@Html.Raw("$0")}
                                </th>
                                 <th style="background-color: silver;text-align: right; font-weight: bold;color:blue; ">  
                                    @if (xTotflujo != 0)
                                    {
                                    @PSename.ToString("#.##")
                                    }
                                    else
                                    {@Html.Raw("0")}
                                %</th>
                                } 
 
            </tr>
            <tr>
                <th style="background-color: silver; text-align: left"> Financimiento </th>
            </tr>
                      <tr style="">
                <th style="text-align: left"> Financiamiento Ing</th>
                @{ 
                                double xTotf2 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 12 || m.CuentaID == 14 || m.CuentaID == 20 || m.CuentaID == 158) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xTotf2 += valorIngresos;

                    <td style=" text-align: right; font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")

                        }
                        else
                        {@Html.Raw("$0")}
                    </td>                  
                }
                 @if (@ViewBag.Mes > 12)
                 { 
                     TotalesREstandar[14] = xTotf2;					  
                      double PSename = (xTotf2 / TotalesREstandar[3])*100; 
                     <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotf2 != 0)
                       { @xTotf2.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                    <th style=" text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotf2 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$0")}
                    %</th>
                 } 

            </tr>
            <tr>
                <th style="text-align: left">Financiamiento Egr</th>
                   @{ 
                 double xAI1 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 155 || e.CuentaIDD == 156 || e.CuentaIDD == 159)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xAI1 += valorEgresos;
                   
                    <td style="text-align: right;font-weight: bold;color:red;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                      TotalesREstandar[15] = xAI1;					  
                      double PSename = (xAI1 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:red;"> 
                       @if (xAI1 != 0)
                       { @xAI1.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                     <th style="text-align: right; font-weight: bold;color:red;"> 
                       @if (xAI1 != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    }
            </tr>
			<tr>
                <th style="text-align: left">Ingresos Préstamos (+)</th>
                   @{ 
                    double xAI11 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 19) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xAI11 = xAI11 + valorIngresos;
                   
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[16] = xAI11;					  
                      double PSename = (xAI11 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI11 != 0)
                       { @xAI11.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI11 != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>
                        <tr>
                <th style="text-align: left">Egresos Préstamos (-)</th>
                   @{ 
                    double xAI12 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 63)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 63)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 63)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xAI12 += valorEgresos;
                   
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                      TotalesREstandar[17] = xAI12;					  
                      double PSename = (xAI12 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI12 != 0)
                       { @xAI12.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI12 != 0)
                        { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>
             <tr style="background-color: silver; text-align: left">
                <th >Total Financiamiento</th>
                  @{ 
                    double xTotfinan = 0;
                   }
                  @foreach (var mes in Meses)
                  {
                      double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                      double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                      double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 63 || e.CuentaIDD == 155 || e.CuentaIDD == 156 || e.CuentaIDD == 159)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                      valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                      double valorIngresos = ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 12 || m.CuentaID == 14 || m.CuentaID == 19 || m.CuentaID == 20 || m.CuentaID == 158) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                      valorEgresos = (valorIngresos - (valorEgresos));
                      xTotfinan += valorEgresos;
                      
                      <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                  }
                    @if (@ViewBag.Mes > 12)
                    { 
                       TotalesREstandar[18] = xTotfinan;					  
                      double PSename = (xTotfinan / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotfinan != 0)
                       { @xTotfinan.ToString("$#,###") }
                       else
                       {@Html.Raw("$0")}
                    </th>
                   <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xTotfinan != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                   %</th>
                      
                    }
              </tr>
            <tr style="background-color: silver; text-align: left">
                <th >Saldo Final Sin DAP</th>
                                 @{ 
                    double xTotDesfinan = 0;
                                }
                                @foreach (var mes in Meses)
                                {


                                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresos = valorEgresos - valor_Reintegros;
                                    //
                                    double valorIngresosFinan = double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 19 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    //valorIngresosFinan -= double.Parse(ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());

                                    double valorEgresosE = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                                    double valor_ReintegrosE = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresosE = valorEgresosE - valor_ReintegrosE;
                                    valorIngresosFinan = valorIngresosFinan - (valorEgresosE);
                                    //


                                    double Valorx = saldoInicial[mes] + (valorIngresos - valorEgresos);
                                    xTotDesfinan += Valorx;
                                    

      
                                    <td style="background-color: silver; text-align: right;font-weight: bold;color:blue; ">
                                        @if (Valorx != 0)
                                        {
                                            @(Valorx.ToString("$#,###"))
                                        }
                                        else
                                        {
                                             @Html.Raw("$0")
                                        }
                                      
                                    </td>

                              



                                }
                                
                              @if (@ViewBag.Mes > 12)
                              {
                                  double valorIngresosT = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                  double valorEgresosT = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                  double valor_ReintegrosT = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                  valorEgresosT = valorEgresosT - valor_ReintegrosT;
                                  //
                                  double valorIngresosFinanT = double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 19 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                  //valorIngresosFinan -= double.Parse(ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());

                                  double valorEgresosET = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                                  double valor_ReintegrosET = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                  valorEgresosET = valorEgresosET - valor_ReintegrosET;
                                  valorIngresosFinanT = valorIngresosFinanT - (valorEgresosET);
                                  //


                                  double ValorxT = saldoInicial[1] + (valorIngresosT - valorEgresosT) + valorIngresosFinanT;
                                    TotalesREstandar[19] = ValorxT;					  
                                    double PSename = (ValorxT / TotalesREstandar[3])*100; 

                                <th style="background-color: silver; text-align: right; font-weight: bold;color:blue">  
                                    @if (ValorxT != 0)
                                    {
                                     @ValorxT.ToString("$#,###")
                                    }
                                    else
                                    {@Html.Raw("$0")}
                                </th>
                                 <th style="background-color: silver; text-align: right; font-weight: bold;color:blue">  
                                    @if (ValorxT != 0)
                                    {
                                      @PSename.ToString("#.##") 
                                    }
                                    else
                                    {@Html.Raw("$0")}
                                %</th>
                              } 

                


            </tr>
			<tr>
			</tr>
		       <tr>
                <th style="text-align: left">DAP</th>
                   @{ 
                              double xAI13 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 40)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 40)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    xAI13 += valorEgresos;
                   
                    <td style="text-align: right;font-weight: bold;color:red;">
                        @if (valorEgresos != 0)
                        {@valorEgresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[20] = xAI13;					  
                        double PSename = (xAI13 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:red;"> 
                       @if (xAI13 != 0)
                       { @xAI13.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:red;"> 
                       @if (xAI13 != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw(" 0")}
                    %</th>
                    }
            </tr>	
                         <tr>
                <th style="text-align: left">Intereses DAP</th>
                   @{ 
                    double xAI111 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 16) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xAI111 = xAI111 + valorIngresos;
                   
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                        TotalesREstandar[21] = xAI111;					  
                        double PSename = (xAI111 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI111 != 0)
                       { @xAI111.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                       <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI111 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw("0")}
                    %</th>
                    }
            </tr>
			   <tr>
                <th style="text-align: left">Rescate DAP</th>
                   @{ 
                    double xAI1122 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 17) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);
                    xAI1122 = xAI1122 + valorIngresos;
                   
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (valorIngresos != 0)
                        {@valorIngresos.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                         TotalesREstandar[22] = xAI1122;					  
                        double PSename = (xAI1122 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI1122 != 0)
                       { @xAI1122.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI1122 != 0)
                       { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw(" 0")}
                    %</th>
                    }
            </tr>
						   <tr>
                <th style="text-align: left">Total DAP</th>
                   @{ 
                    double xAI1123 = 0;
                }
                @foreach (var mes in Meses)
                {
                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 40)).Sum(m => m.Monto).ToString());
                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 40)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                    double valor_GastosReintegros = double.Parse(reintegrosGastos.Where(d => d.Reintegro.Cuenta.Codigo.Equals("7.1.9")).Where(e => (e.CuentaIDD == 40)).Where(d => d.Reintegro.Mes == mes).Where(d => d.Reintegro.Periodo == periodo).Sum(d => d.Monto).ToString());
                    valorEgresos = (valorEgresos + valor_GastosReintegros) - valor_Reintegros;
                    double valorIngresos = ingresos.Where(m => (m.CuentaID == 17 || m.CuentaID == 16) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos);

                    double ValorMostrar = valorIngresos - valorEgresos;
                    xAI1123 = xAI1123 + ValorMostrar;
                   
                    <td style="text-align: right;font-weight: bold;color:blue;">
                        @if (ValorMostrar != 0)
                        {@ValorMostrar.ToString("$#,###")}
                        else
                        {@Html.Raw("$0")}
                    </td>  
                }
                    @if (@ViewBag.Mes > 12)
                    { 
                          TotalesREstandar[23] = xAI1123;					  
                        double PSename = (xAI1123 / TotalesREstandar[3])*100; 
                     <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI1123 != 0)
                       { @xAI1123.ToString("$#,###") }
                       else
                       {@Html.Raw("$ 0")}
                    </th>
                    <th style="text-align: right; font-weight: bold;color:blue;"> 
                       @if (xAI1123 != 0)
                      { @PSename.ToString("#.##") }
                       else
                       {@Html.Raw(" 0")}
                    %</th>
                    }
            </tr>
               <tr style="background-color: silver; text-align: left">
                <th >Saldo Final</th>
                                 @{ 
                    double xTotDesfinan2 = 0;
                                }
                                @foreach (var mes in Meses)
                                {


                                    double valorIngresos = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Mes == mes && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    double valorEgresos = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79 || e.CuentaID == 40)).Sum(m => m.Monto).ToString());
                                    double valor_Reintegros = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresos = valorEgresos - valor_Reintegros;
                                    //
                                    double valorIngresosFinan = double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 19 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                    //valorIngresosFinan -= double.Parse(ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());

                                    double valorEgresosE = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Mes == mes && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                                    double valor_ReintegrosE = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Mes == mes).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                    valorEgresosE = valorEgresosE - valor_ReintegrosE;
                                    valorIngresosFinan = valorIngresosFinan - (valorEgresosE);
                                    //


                                    double Valorx = saldoInicial[mes] + (valorIngresos - valorEgresos) + valorIngresosFinan;
                                    xTotDesfinan2 += Valorx;
                                    

      
                                    <td style="background-color: silver; text-align: right;font-weight: bold;color:blue; ">
                                        @if (Valorx != 0)
                                        {
                                            @(Valorx.ToString("$#,###"))
                                        }
                                        else
                                        {
                                             @Html.Raw("$0")
                                        }
                                      
                                    </td>
                           



                                }
                                
                              @if (@ViewBag.Mes > 12)
                              {
                                  double valorIngresosT = double.Parse(ingresos.Where(e => (e.CuentaID == 3 || e.CuentaID == 4 || e.CuentaID == 5 || e.CuentaID == 8 || e.CuentaID == 12) && e.Temporal == null && e.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                  double valorEgresosT = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Sum(m => m.Monto).ToString());
                                  double valor_ReintegrosT = double.Parse(reintegros.Where(e => (e.CuentaID == 127 || e.CuentaID == 101 || e.CuentaID == 102 || e.CuentaID == 104 || e.CuentaID == 43 || e.CuentaID == 22 || e.CuentaID == 23 || e.CuentaID == 25 || e.CuentaID == 26 || e.CuentaID == 27 || e.CuentaID == 28 || e.CuentaID == 163 || e.CuentaID == 41 || e.CuentaID == 33 || e.CuentaID == 34 || e.CuentaID == 35 || e.CuentaID == 36 || e.CuentaID == 44 || e.CuentaID == 125 || e.CuentaID == 123 || e.CuentaID == 123 || e.CuentaID == 62 || e.CuentaID == 48 || e.CuentaID == 49 || e.CuentaID == 52 || e.CuentaID == 53 || e.CuentaID == 54 || e.CuentaID == 55 || e.CuentaID == 56 || e.CuentaID == 57 || e.CuentaID == 58 || e.CuentaID == 147 || e.CuentaID == 149 || e.CuentaID == 150 || e.CuentaID == 151 || e.CuentaID == 153 || e.CuentaID == 154 || e.CuentaID == 50 || e.CuentaID == 59 || e.CuentaID == 60 || e.CuentaID == 61 || e.CuentaID == 64 || e.CuentaID == 145 || e.CuentaID == 66 || e.CuentaID == 146 || e.CuentaID == 68 || e.CuentaID == 69 || e.CuentaID == 70 || e.CuentaID == 72 || e.CuentaID == 73 || e.CuentaID == 74 || e.CuentaID == 76 || e.CuentaID == 75 || e.CuentaID == 77 || e.CuentaID == 78 || e.CuentaID == 79)).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                  valorEgresosT = valorEgresosT - valor_ReintegrosT;
                                  //
                                  double valorIngresosFinanT = double.Parse(ingresos.Where(m => (m.CuentaID == 10 || m.CuentaID == 14 || m.CuentaID == 16 || m.CuentaID == 17 || m.CuentaID == 19 || m.CuentaID == 158 || m.CuentaID == 20) && m.Temporal == null && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());
                                  //valorIngresosFinan -= double.Parse(ingresos.Where(m => (m.CuentaID == 40 || m.CuentaID == 63 || m.CuentaID == 155 || m.CuentaID == 156 || m.CuentaID == 157) && m.Temporal == null && m.Mes == mes && m.Periodo == periodo).Sum(m => m.Monto_Ingresos).ToString());

                                  double valorEgresosET = double.Parse(egresos.Where(e => e.Egreso.Temporal == null && e.Egreso.Periodo == periodo && (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Sum(m => m.Monto).ToString());
                                  double valor_ReintegrosET = double.Parse(reintegros.Where(e => (e.CuentaID == 63 || e.CuentaID == 155 || e.CuentaID == 156 || e.CuentaID == 159)).Where(d => d.Periodo == periodo).Sum(d => d.Monto_Ingresos).ToString());
                                  valorEgresosET = valorEgresosET - valor_ReintegrosET;
                                  valorIngresosFinanT = valorIngresosFinanT - (valorEgresosET);
                                  //


                                  double ValorxT = saldoInicial[1] + (valorIngresosT - valorEgresosT) + valorIngresosFinanT;
                                   TotalesREstandar[24] = ValorxT;					  
                                    double PSename = (ValorxT / TotalesREstandar[3])*100; 
                               
                                <th style="background-color: silver; text-align: right; font-weight: bold;color:blue">  
                                    @if (ValorxT != 0)
                                    {
                                     @ValorxT.ToString("$#,###")
                                    }
                                    else
                                    {@Html.Raw("$0")}
                                </th>
                                  <th style="background-color: silver; text-align: right; font-weight: bold;color:blue">  
                                    @if (ValorxT != 0)
                                    {
                                    @PSename.ToString("#.##")
                                    }
                                    else
                                    {@Html.Raw("0")}
                                %</th>
                              } 

                


            </tr>
        </table>
		<br><br>
    </div>
    }
    catch
    {

    }

}

